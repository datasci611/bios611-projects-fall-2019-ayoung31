sum(dbinom(c(7:14),14,.21))
sum(dbinom(c(6:14),14,.21))
sum(dbinom(c(6:14),14,.21))
qf(.95,22,8)
4/(4+11*qf(.95,22,8))
qf(.95, 10, 20)
5/(5+10*qf(.95, 10, 20))
4/14
5/(5+10/qf(.95, 10, 20))
4/14
qnorm
qnorm(.05)
l <- 1.64*sqrt(.2857*(1-.2857)/14)
.2857+l
.2857-l
tabl <- "
| Courses | Alive | Dead  |
|---------|:-----:|------:|
| 1-4     | 2     | 21    |
| >=10    | 8     | 2     |
"
cat(tabl)
tabl <- "
| Courses | Alive | Dead  |
|---------|:-----:|------:|
| 1-4     | 2     | 21    | n1
| >=10    | 8     | 2     | n2
|---------|:-----:|------:|
m1     m2
"
cat(tabl)
tabl <- "
| Courses | Alive | Dead  |
|---------|:-----:|------:|
| 1-4     | 2     | 21    | n1=23
| >=10    | 8     | 2     | n2=10
|---------|:-----:|------:|
m1=10   m2=23
"
cat(tabl)
table <- matrix(c(302,27,5,40,55,9,1,9,18), nrow=3, byrow=T)
Kappa(table)
library(vcd)
install.packages("vcd")
Kappa(table)
library(vcd)
Kappa(table)
table <- matrix(c(7,5),c(100,431))
table
table <- matrix(c(7,5),c(100,431), nrow=2)
table
table <- matrix(c(7,5,100,431), nrow=2)
table
table <- matrix(c(7,100,5,431), nrow=2)
table
fisher.test(table)
table
table <- matrix(c(7,5,100,431), nrow=2)
table
fisher.test(table)
## Problem 1
matrix(c(41, 48, 50, 40), ncol=2)
## Problem 1
matrix(c(41, 50, 63, 48, 40, 27), ncol=2)
## Problem 1
table <- matrix(c(41, 50, 63, 48, 40, 27), ncol=2)
fisher.test(table)
#Part b
table <- matrix(59, 39, 57, 53, 34, 28)
#Part b
table <- matrix(c(59, 39, 57, 53, 34, 28), ncol=2)
fisher.test(table)
## Problem 2
Table6_12<-array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+")))
Table6_12
Table6_12
## Problem 2
Table6_12<-data.frame(array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+"))))
Table6_12
## Problem 2
Table6_12<-array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+")))
rbindlist(Table6_12)
library(data.table)
rbindlist(Table6_12)
## Problem 2
Table6_12<-list(array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+"))))
rbindlist(Table6_12)
## Problem 2
Table6_12<-array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+")))
## Problem 2
Table6_12<-as.list(array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
## Problem 2
Table6_12<-as.list(array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+"))))
rbindlist(Table6_12)
## Problem 2
Table6_12<-as.list(array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+"))))
rbindlist(Table6_12)
## Problem 2
Table6_12<-array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+")))
Table6_12
dimSums(Table6_12, 3)
install.packages("CHNOSZ")
library(CHNOSZ)
dimSums(Table6_12, 3)
Table6_11 <- dimSums(Table6_12, 3)
#Part b
oddsratio.wald(Table6_11)
library(epitools)
#Part b
oddsratio.wald(Table6_11)
#Part b
oddsratio.wald(Table6_11)$measure
oddsratio.wald(Table6_12)$measure
## Problem 2
Table6_12<-array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+")))
#Part a
Table6_11 <- dimSums(Table6_12, 3)
#Part b
oddsratio.wald(Table6_11)$measure
oddsratio.wald(Table6_12)$measure
oddsratio.wald(Table6_12, nrow=14)$measure
Table6_12
data.frame(Table\)
data.frame(Table6_12)
slice(Table6_12, d=3)
list2array(Table6_12)
list2array(Table6_12, d=3)
mantelhaen.test(Table6_12)
#Part b
oddsratio.wald(Table6_11)$measure
mantelhaen.test(Table6_12)
#Part a
mantelhaen.test(Table6_12)
sum(dbinom(7:16, 23, .5))
sum(dbinom(6:18, 23, .5))
#Part a
table <- matrix(c(41, 50, 63, 48, 40, 27), ncol=2)
chisq.test(table)$stdres
2*pnorm(-.4)
2*pnorm(-2.61)
2*pnorm(-.4)
prop.table(table, margin=2)*100
prop.table(table, margin=1)*100
#Part a
table <- matrix(c(41, 50, 63, 48, 40, 27), ncol=2)
chisq.test(table)
#Part b
table <- matrix(c(59, 39, 57, 53, 34, 28), ncol=2)
chisq.test(table)$stdres
prop.table(table, margin=3)*100
prop.table(table, margin=0)*100
#Part b
table <- matrix(c(59, 39, 57, 53, 34, 28), ncol=2)
chisq.test(table)
pchisq(2, .95)
qchisq(2, .95)
pchisq(2, .95)
qchisq(2, .95)
qchisq(.95,2)
#read in table
Table6_12<-array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+")))
Table6_11 <- dimSums(Table6_12, 3)
library(CHNOSZ)
Table6_11 <- dimSums(Table6_12, 3)
Table6_11
oddsratio.wald(Table6_11)$measure
library(epitools)
oddsratio.wald(Table6_11)$measure
Table6_12
slice(Table6_12, d=3)
for(j in 1:7){
table <- slice(Table6_12, d=3, i=j)
oddsratio.wald(table)$measure
}
oddsratio.small(table)$measure
for(j in 1:7){
table <- slice(Table6_12, d=3, i=j)
oddsratio.small(table)$measure
}
for(j in c(1:7)){
table <- slice(Table6_12, d=3, i=j)
oddsratio.small(table)$measure
}
for(j in c(1:7)){
table <- slice(Table6_12, d=3, i=j)
oddsratio(table)$measure
}
for(j in c(1:7)){
table <- slice(Table6_12, d=3, i=j)
oddsratio.fisher(table)$measure
}
oddsratio.fisher(table)$measure
table <- slice(Table6_12, d=3, i=1)
oddsratio.fisher(table)$measure
table <- slice(Table6_12, d=3, i=2)
oddsratio.fisher(table)$measure
oddsratio.wald(table)$measure
oddsratio.wald(table)$measure
Table6_12[,,j]
dimnames(Table6_12[,,j])
dimnames(Table6_12[j,,])
dimnames(Table6_12[,j,])
dimnames(Table6_12[1,2,j])
dimnames(Table6_12[1,1,j])
dimnames(Table6_12[1,,j])
dimnames(Table6_12[,,j])
mantelhaen.test(Table6_12)
dchisq(.95, 1)
pchisq(.95, 1)
mantelhaen.test(Table6_12)
odds <- numeric()
odds <- numeric(7)
odds[1] <- 1.104
odds
odds <- numeric(7)
odds[1] <- 1.104
odds[2] <- 2.178
odds[3] <- 1.008
odds[4] <- 1.737
odds[5] <- 1.558
odds[6] <- 1.186
odds[7] <- 0.882
odds
Table6_12
mymatrix <- as.data.frame(matrix(c((269*7)/(55*31), (112*7)/(18*20), (114*7)/(24*33), (172*40)/(45*88), (55*34)/(50*24), (58*27)/(55*24), (17*30)/(17*34)), nrow = 7))
mymatrix
odds <- matrix(nrow=7)
odds[1] <- 1.104
odds[2] <- 2.178
odds[3] <- 1.008
odds[4] <- 1.737
odds[5] <- 1.558
odds[6] <- 1.186
odds[7] <- 0.882
odds
odds <- data.frame(matrix(nrow=7))
odds[1] <- 1.104
odds[2] <- 2.178
odds[3] <- 1.008
odds[4] <- 1.737
odds[5] <- 1.558
odds[6] <- 1.186
odds[7] <- 0.882
odds
odds <- data.frame(matrix(nrow=7))
odds[,1] <- 1.104
odds[,2] <- 2.178
odds[,3] <- 1.008
odds[,4] <- 1.737
odds[,5] <- 1.558
odds[,6] <- 1.186
odds[,7] <- 0.882
odds
odds <- data.frame(matrix(nrow=7))
odds <- data.frame()
odds$or <- c(1.104, 2.178, 1.008, 1.737, 1.558, 1.186, 0.882)
odds <- data.frame(matrix(nrow=7))
odds$or <- c(1.104, 2.178, 1.008, 1.737, 1.558, 1.186, 0.882)
odds
odds <- data.frame(matrix(c(1.104, 2.178, 1.008, 1.737, 1.558, 1.186, 0.882), nrow=7))
odds
colnames(odds) <- "or"
odds
odds$logor <- log(odds$or)
odds
odds$var <- c((1/269 + 1/55 + 1/31 + 1/7),
(1/112 + 1/20 + 1/18 + 1/7),
(1/114 + 1/33 + 1/24 + 1/7),
(1/172 + 1/88 + 1/45 + 1/40),
(1/55 + 1/50 + 1/24 + 1/34),
(1/58 + 1/55 + 1/24 + 1/27),
(1/17 + 1/34 + 1/17 + 1/30))
odds$inv_var <- 1/odds$var
odds$a <- odds$logor
odds$asq <- odds$a^2
View(odds)
odds$avar <- odds$asq/odds$var
sum(odds$avar)
odds$varinv <- 1/odds$var
odds$avar <- odds$a * odds$varinv
odds$abar <- sum(odds$avar) / sum(odds$varinv)
abar <- sum(odds$avar) / sum(odds$varinv)
odds <- data.frame(matrix(c(1.104, 2.178, 1.008, 1.737, 1.558, 1.186, 0.882), nrow=7))
colnames(odds) <- "or"
odds$logor <- log(odds$or)
odds$var <- c((1/269 + 1/55 + 1/31 + 1/7),
(1/112 + 1/20 + 1/18 + 1/7),
(1/114 + 1/33 + 1/24 + 1/7),
(1/172 + 1/88 + 1/45 + 1/40),
(1/55 + 1/50 + 1/24 + 1/34),
(1/58 + 1/55 + 1/24 + 1/27),
(1/17 + 1/34 + 1/17 + 1/30))
odds$a <- odds$logor
odds$asq <- odds$a^2
odds$varinv <- 1/odds$var
odds$avar <- odds$a * odds$varinv
abar <- sum(odds$avar) / sum(odds$varinv)
abarsq <- (sum(odds$avar) / sum(odds$varinv))^2
chisq <- abarsq * sum(odds$varinv)
chisq
mymatrix <- as.data.frame(matrix(c((269*7)/(55*31), (112*7)/(18*20), (114*7)/(24*33), (172*40)/(45*88), (55*34)/(50*24), (58*27)/(55*24), (17*30)/(17*34)), nrow = 7))
#a values
mymatrix$a <- log(mymatrix$V1)
mymatrix$s_squared <- 0
#s^2 values
mymatrix[1,3] <- (1/269 + 1/55 + 1/31 + 1/7)
mymatrix[2,3] <- (1/112 + 1/20 + 1/18 + 1/7)
mymatrix[3,3] <- (1/114 + 1/33 + 1/24 + 1/7)
mymatrix[4,3] <- (1/172 + 1/88 + 1/45 + 1/40)
mymatrix[5,3] <- (1/55 + 1/50 + 1/24 + 1/34)
mymatrix[6,3] <- (1/58 + 1/55 + 1/24 + 1/27)
mymatrix[7,3] <- (1/17 + 1/34 + 1/17 + 1/30)
#s^2 inverse
mymatrix$s_squared_inv <- 1/mymatrix$s_squared
#a^2/s^2
mymatrix$aovers_squared <- mymatrix$a^2/mymatrix$s_squared
#a/s^2
mymatrix$aoverssquared <- mymatrix$a/mymatrix$s_squared
a_bar <- sum(mymatrix$aoverssquared)/sum(mymatrix$s_squared_inv)
chi2_a <- a_bar^2*sum(mymatrix$s_squared_inv)
chi2_a
chisq
#overall odds
exp(abar)
lower <- exp(abar - (1.96/sqrt(sum(odds$varinv))))
lower
upper <- exp(abar + (1.96/sqrt(sum(odds$varinv))))
or
#overall odds
or <- exp(abar)
lower <- exp(abar - (1.96/sqrt(sum(odds$varinv))))
upper <- exp(abar + (1.96/sqrt(sum(odds$varinv))))
or
lower
upper
df <- data.frame(c(1:12), c( 22, 23, 22, 15, 21, 15, 17, 18, 19, 14, 24, 20))
colnames(df) <- c("month", "deaths")
View(df)
lambdahat <- sum(df$deaths)/12
lambdahat <- sum(df$deaths)/12
lower <- .5 * qchisq(0.025, df = sum(df$deaths)*2)/12
upper <- .5 * qchisq(0.025, df = sum(df$deaths, 1)*2)
upper <- .5 * qchisq(0.025, df = sum(df$deaths, 1)*2)/12
lambdahat
lower
upper
upper <- .5 * qchisq(0.075, df = sum(df$deaths, 1)*2)/12
lambdahat
lower
upper
upper <- .5 * qchisq(0.075, df = (sum(df$deaths)+1)*2)/12
upper
lambdahat
lower
upper
upper <- .5 * qchisq(0.975, df = (sum(df$deaths)+1)*2)/12
upper
var <- var(df$deaths)
mean <-mean(df$deaths)
chi2 <- 11*var/mean
pchisq(chi2, df = 11)
pchisq(chi2, df = 11)
var <- var(df$deaths)
mean <-mean(df$deaths)
df <- data.frame(c(1:12), c( 22, 23, 22, 15, 21, 15, 17, 18, 19, 14, 24, 20))
colnames(df) <- c("month", "deaths")
lambdahat <- sum(df$deaths)/12
lower <- .5 * qchisq(0.025, df = sum(df$deaths)*2)/12
upper <- .5 * qchisq(0.975, df = (sum(df$deaths)+1)*2)/12
lambdahat
lower
upper
var <- var(df$deaths)
mean <-mean(df$deaths)
chi2 <- 11*var/mean
pchisq(chi2, df = 11)
qchisq(.95, df = 11)
pchisq(.95, df = 11)
dchisq(.95, df = 11)
qchisq(.95, df = 11)
chisq <- 11*var/mean
chisq
qchisq(.95, df = 11)
chisq
qchisq(.95, df = 11)
qchisq(.95, 1)
mantelhaen.test(Table6_12)
#read in table
Table6_12<-array(c(7,55,31,269,7,20,18,112,7,33,24,114,40,88,45,172,
34,50,24,55,27,55,24,58,30,34,17,17),
dim=c(2,2,7),
dimnames=list(CupsCoffee=c("GE5","LT5"),MIcase=c("Yes","No"),
Smoking=c("Never","Former","1-14","15-24","25-34","35-44","45+")))
mantelhaen.test
mantelhaen.test(Table6_12)
qchisq(.95, 1)
setwd("~/GitHub/bios611-projects-fall-2019-ayoung31/project_2")
shiny::runApp()
runApp()
runApp()
raw <- read()
df <- clean(raw)
weeklyVals <- makeWeekly(df)
DailyVals <- makeDaily(df)
runApp()
runApp()
runApp()
runApp()
weekpred <- function(){
new <- data.frame(c(1,2,3,4,5))
colnames(new) <- "weekdayNum"
return(new)
}
new <- weekpred()
runApp()
runApp()
runApp()
runApp()
raw <- read()
df <- clean(raw)
raw <- read()
source("helper_functions.R")
raw <- read()
df <- clean(raw)
weeklyVals <- makeWeekly(df)
DailyVals <- makeDaily(df)
new <- weekpred()
predicted <- predict(new)
predicted <- predict(new, `Pounds of Food`)
source("helper_functions.R")
predicted <- predict(new, `Pounds of Food`, DailyVals)
raw <- read()
df <- clean(raw)
weeklyVals <- makeWeekly(df)
DailyVals <- makeDaily(df)
new <- weekpred()
predicted <- predict(new, `Pounds of Food`, DailyVals)
predicted <- predict(new, DailyVals$`Pounds of Food`, DailyVals)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
return(predicted)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
predicted <- prediction(DailyVals, input$option1, new)
raw <- read()
df <- clean(raw)
weeklyVals <- makeWeekly(df)
DailyVals <- makeDaily(df)
new <- weekpred()
predicted <- prediction(DailyVals, input$option1, new)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
